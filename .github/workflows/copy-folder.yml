name: Copy Folder to realchart-demo

on:
  push:
    branches:
      - release/v1.1.0
    paths:
      - 'fiddle/**'

jobs:
  copy-folder:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout source repository
      uses: actions/checkout@v2

    - name: Copy folder to destination repository
      env:
        TOKEN: ${{ secrets.REAL_CHART_FIDDLE_TOKEN }}
      run: |
        git config --global user.email "dltlghkd930217@gmail.com"
        git config --global user.name "dltlghkd930217"
        
        git clone https://x-access-token:$TOKEN@github.com/realgrid/realchart-demo.git
        cp -r fiddle/* realchart-demo/

        echo '#!/bin/bash' > commit_and_push.sh
        echo 'if [[ $(git status --porcelain) ]]; then' >> commit_and_push.sh
        echo '    git add .' >> commit_and_push.sh
        echo '    git commit -m "Copied folder for fiddle demo"' >> commit_and_push.sh
        echo '    git push' >> commit_and_push.sh
        echo 'else' >> commit_and_push.sh
        echo '    echo "No changes to commit."' >> commit_and_push.sh
        echo 'fi' >> commit_and_push.sh

        chmod +x commit_and_push.sh
        ./commit_and_push.sh
